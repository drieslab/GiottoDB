<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro â€¢ Duckling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro">
<meta property="og:description" content="Duckling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Duckling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark-logNormalization.html">Benchmarking DuckDB and Sparse Matrix Operation</a>
    </li>
    <li>
      <a href="../articles/intro.html">Intro</a>
    </li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Ed2uiz/duckling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intro</h1>
            
            <h4 data-toc-skip class="date">2023-09-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Ed2uiz/duckling/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="backend-framework">Backend Framework<a class="anchor" aria-label="anchor" href="#backend-framework"></a>
</h3>
<div class="section level4">
<h4 id="creating-a-backend">1. Creating a backend<a class="anchor" aria-label="anchor" href="#creating-a-backend"></a>
</h4>
<p>The first step is to create a <em>Duckling</em> backend. The database
driver and filepath (defaults to duckdb and a temporary directory
respectively) is provided at this step. This provides a centralized
location from which to retrieve connections to the database.</p>
<pre><code><span><span class="va">bID</span> <span class="op">=</span> <span class="fu"><a href="../reference/createBackend.html">createBackend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bID</span> <span class="co"># hash ID value for the database file</span></span></code></pre>
<p>Each database filepath in use is assigned an unique identifier which
is returned invisibly.</p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div class="section level4">
<h4 id="interacting-with-the-backend">1.1 Interacting with the backend<a class="anchor" aria-label="anchor" href="#interacting-with-the-backend"></a>
</h4>
<p>This package uses <em>pool</em> to abstract away connection handling.
To retrieve a pool of connections from the backend.</p>
<pre><code><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/getBackendPool.html">getBackendPool</a></span><span class="op">(</span><span class="va">bID</span><span class="op">)</span></span></code></pre>
<p>This is one of several functions to work with the backend. Other
examples are below. Most are not needed for users because they are used
internally.</p>
<ul>
<li>
<code><a href="../reference/getBackendID.html">getBackendID()</a></code> get backend ID hash based on the full
database filepath
</li>
<li>
<code><a href="../reference/getBackendPool.html">getBackendPath()</a></code> get the specified database filepath using
the backend ID hash
</li>
<li>
<code><a href="../reference/getBackendEnv.html">getBackendEnv()</a></code> retrieves the active backend environment
that is holding all connection details and connection pools
</li>
<li>
<code><a href="../reference/getBackendPool.html">getBackendConn()</a></code> get a <em>DBI</em> connection object to
the specified database.
</li>
<li>
<code><a href="../reference/getBackendPool.html">getBackendInfo()</a></code> get the <code>backendInfo</code> object
that holds connection details for the specified database.
</li>
</ul>
<p><span class="math inline">\(~\)</span></p>
</div>
<div class="section level4">
<h4 id="closing-and-reconnecting-the-backend">2. Closing and reconnecting the backend<a class="anchor" aria-label="anchor" href="#closing-and-reconnecting-the-backend"></a>
</h4>
<p>The specified backend can be closed using
<code><a href="../reference/closeBackend.html">closeBackend()</a></code>, this is generally not necessary to be
manually run. All backends and associated connections will be finalized
at the end of the session.<br><em>Duckling</em> data objects ask for new pool connections to the
database from the backend when the connections are closed or otherwise
become invalid. When the backend itself is closed, the user must
reconnect the backend.<br>
Reconnections to an existing backend can be performed using the
associated <code>backendInfo</code> object using
<code><a href="../reference/reconnectBackend-generic.html">reconnectBackend()</a></code></p>
<pre><code><span><span class="co"># keep backend connection details</span></span>
<span><span class="va">bInfo</span> <span class="op">=</span> <span class="fu"><a href="../reference/getBackendPool.html">getBackendInfo</a></span><span class="op">(</span><span class="va">bID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="co"># still valid</span></span>
<span><span class="fu"><a href="../reference/closeBackend.html">closeBackend</a></span><span class="op">(</span><span class="va">bID</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="co"># now invalid </span></span>
<span></span>
<span><span class="fu"><a href="../reference/reconnectBackend-generic.html">reconnectBackend</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/getBackendPool.html">getBackendPool</a></span><span class="op">(</span><span class="va">bID</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="co"># new valid pool connection</span></span></code></pre>
<p><span class="math inline">\(~\)</span></p>
</div>
</div>
<div class="section level3">
<h3 id="writing-values-into-the-database">Writing values into the database<a class="anchor" aria-label="anchor" href="#writing-values-into-the-database"></a>
</h3>
<p><em>Duckling</em> implements a number of S4 structures to represent
database tables as more familiar data types. (See the class hierarchy
diagram in docs)</p>
<div class="section level4">
<h4 id="creating-objects">1 Creating objects<a class="anchor" aria-label="anchor" href="#creating-objects"></a>
</h4>
<p>If a <code>character</code> input is provided to the object creation
functions then the values will be read into the database and a
database-backed representation of that data will be created.</p>
<ul>
<li>
<code><a href="../reference/createDBMatrix.html">createDBMatrix()</a></code> (WIP)
</li>
<li>
<code><a href="../reference/createDBDataFrame.html">createDBDataFrame()</a></code> (WIP)
</li>
<li>
<code><a href="../reference/createDBPolygonProxy.html">createDBPolygonProxy()</a></code>
</li>
<li>
<code>createDBPointProxy()</code>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="chunked-reading">1.1 Chunked reading<a class="anchor" aria-label="anchor" href="#chunked-reading"></a>
</h4>
<p>Data that requires out of memory processing is often too large to
load into memory and be written into the database in a single step.
<em>Duckling</em> reads in values in a chunked manner to get around
this.</p>
<code><a href="../reference/streamToDB_fread.html">streamToDB_fread()</a></code> and
<code><a href="../reference/streamSpatialToDB_arrow.html">streamSpatialToDB_arrow()</a></code> (still experimental likely to
change in the future) are the functions to read data in in a chunked
manner. A table is created using <code><a href="../reference/createTableBE.html">createTableBE()</a></code> (currently
internal), then the chunks are read into the database. These functions
(and also the object creation functions) expose parameters for how the
chunked reading occurs. Important params include:
<ul>
<li>
<code>callback</code> a function to apply to each read in chunk of data
(mainly for data cleaning and formatting purposes) before it gets
written into the database as a table. This function should take a
data.table as input and output a data.table as well
</li>
<li>
<code>custom_table_fields</code> (advanced) specify SQL specific data
types and constraints for columns to use when creating the database
table for this data. If not provided for any column, default schemas
decided by <em>DBI</em> will be used for that column.
</li>
<li>
<code>pk</code> assign a primary key column when creating the database
table
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="database-settings">Database settings<a class="anchor" aria-label="anchor" href="#database-settings"></a>
</h3>
<p>Database and PRAGMA settings can be retrieved and set using
<code><a href="../reference/dbSettings.html">dbSettings()</a></code></p>
<pre><code><span><span class="fu"><a href="../reference/dbSettings.html">dbSettings</a></span><span class="op">(</span><span class="va">bID</span>, <span class="st">'memory_limit'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dbSettings.html">dbSettings</a></span><span class="op">(</span><span class="va">bID</span>, <span class="st">'memory_limit'</span>, <span class="st">'2GB'</span><span class="op">)</span></span></code></pre>
<p>Some settings have dedicated convenience functions like
<code><a href="../reference/dbMemoryLimit.html">dbMemoryLimit()</a></code></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edward Ruiz, Jiaji George Chen, Ruben Dries.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
